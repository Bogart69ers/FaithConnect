@model FaithConnect.ViewModel.GroupDetailViewModel
@{
    ViewBag.Title = Model.Group.groupName;
    Layout = "~/Views/Shared/_Layout.cshtml";

    var memberCount = Model.GroupMemberships.Count(m => m.groupId == Model.Group.id && m.status == 1);
    var currentUserId = ViewBag.CurrentUserId;
}

<link rel="stylesheet" href="~/Assets/Groups/css/GroupDetail.css" />
<div class="container-fluid mt-4">
    <div class="row">
        <div class="col-12">
            <!-- Group Banner Section -->
            <div class="group-header" style="position: relative;">
                <img src="~/Assets/Groups/img/group1.jpg" alt="Group Header" class="img-fluid group-banner">
                <div class="group-info" style="position: absolute; bottom: 30px; left: 30px; color: white;">
                    <h2>@Model.Group.groupName</h2>
                    <p>@memberCount members</p>
                    <!-- If the logged-in user is the group admin, show the "Edit Group" button -->
                    @if (Model.Group.groupAdmin == currentUserId)
                    {
                        <a href="@Url.Action("EditGroup", "Group", new { id = Model.Group.id })" class="btn btn-custom">Edit Group</a>
                    }
                    else if(Model.Groupmembership.userId == currentUserId && Model.Groupmembership.status == 1)
                    {
                        <!-- If the user is not the admin, show the "Join Group" button -->
                        <button class="btn btn-custom">Invite</button>
                        <button class="btn btn-custom">Leave</button>

                    }
                    else
                    {
                        <button class="btn btn-custom">Join Group</button>

                    }
                </div>
            </div>
        </div>
    </div>

    <!-- Navigation Tabs -->
    <ul class="nav nav-tabs mt-3 group-navigation">
        <li class="nav-item">
            <a class="nav-link active" data-toggle="tab" href="#content">Contents</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#events">Events</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" data-toggle="tab" href="#forums">Forums</a>
        </li>
    </ul>

    <div class="tab-content row mt-4">
        <!-- Left Section: Posts -->
        <div class="tab-pane container active col-lg-8" id="content">
            @foreach (var post in Model.Posts)
            {
                <div class="card mt-3">
                    <div class="card-body">
                        <h5>@post.UserAccount.username <small class="text-muted">(@post.UserAccount.role)</small></h5>
                        <p class="text-muted">@post.date_created?.ToString("MMMM dd, yyyy")</p>
                        <p>@post.content</p>
                    </div>
                </div>
            }
        </div>

        <!-- Right Section: Upcoming Events -->
        @*<div class="col-lg-4">
            <div class="upcoming-events">
                <h4>Upcoming Events:</h4>
                @foreach (var event in Model.Events)
                {
                    <div class="event d-flex mb-3">
                        <div class="event-date p-2 text-center" style="background-color: #e9ecef; border-radius: 5px;">
                            <h5>@event.Date.ToString("ddd")</h5>
                            <span>@event.Date.Day</span>
                        </div>
                        <div class="event-details p-2 ml-2">
                            <h5>@event.Title</h5>
                            <p>@event.Description</p>
                        </div>
                    </div>
                            }
            </div>
        </div>*@
    </div>
</div>


<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJTY5KVphtPhzWj9WO1clHTMGaEkaGQ2J95JCzy/8p3ylzTEi" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-pjaaA8dDz/UmAGHEmpNMI0HHLmV7xI5a2zVzt95Z5CjoFQ7p1rR/YL2cw6K9/6Nf" crossorigin="anonymous"></script>
